<!DOCTYPE html>
<html>
<body style="margin:0; background:black; overflow:hidden;">
    <video id="v" autoplay playsinline style="position:fixed; width:100vw; height:100vh; object-fit:cover;"></video>
    <canvas id="c" style="position:fixed; width:100vw; height:100vh; object-fit:cover; pointer-events:none;"></canvas>

    <script>
        const v = document.getElementById('v');
        const c = document.getElementById('c');
        const ctx = c.getContext('2d');

        navigator.mediaDevices.getUserMedia({ video: { facingMode: "environment" } })
            .then(s => { v.srcObject = s; });

        function rgbToHsl(r, g, b) {
            r /= 255, g /= 255, b /= 255;
            let max = Math.max(r, g, b), min = Math.min(r, g, b);
            let h, s, l = (max + min) / 2;
            if (max == min) { h = s = 0; } 
            else {
                let d = max - min;
                s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
                switch (max) {
                    case r: h = (g - b) / d + (g < b ? 6 : 0); break;
                    case g: h = (b - r) / d + 2; break;
                    case b: h = (r - g) / d + 4; break;
                }
                h /= 6;
            }
            return [h * 360, s * 100, l * 100];
        }

        function render() {
            if (v.videoWidth > 0) {
                c.width = v.videoWidth / 4; 
                c.height = v.videoHeight / 4;
                ctx.clearRect(0, 0, c.width, c.height);
                
                const tempCanvas = document.createElement('canvas');
                tempCanvas.width = c.width;
                tempCanvas.height = c.height;
                const tempCtx = tempCanvas.getContext('2d');
                tempCtx.drawImage(v, 0, 0, c.width, c.height);
                
                let f = tempCtx.getImageData(0, 0, c.width, c.height);
                let d = f.data;

                for (let i = 0; i < d.length; i += 4) {
                    let [h, s, l] = rgbToHsl(d[i], d[i+1], d[i+2]);
                    
                    // GREEN HUE RANGE: 70 to 170 covers Lime and Green
                    // S > 25: Ensures the color is vivid (not grey/white paper)
                    // L < 85: Ensures it's not pure bright white light
                    if (h > 70 && h < 170 && s > 25 && l < 85) {
                        d[i] = 0; d[i+1] = 0; d[i+2] = 0; d[i+3] = 255; 
                    } else {
                        d[i+3] = 0; 
                    }
                }
                ctx.putImageData(f, 0, 0);
                c.style.filter = "blur(12px) contrast(150%)"; 
            }
            requestAnimationFrame(render);
        }
        v.onplay = () => render();
    </script>
</body>
</html>
