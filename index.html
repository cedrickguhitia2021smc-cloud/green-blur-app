<!DOCTYPE html>
<html>
<body style="margin:0; background:black; overflow:hidden;">
    <video id="v" autoplay playsinline style="position:fixed; width:100vw; height:100vh; object-fit:cover;"></video>
    <canvas id="c" style="position:fixed; width:100vw; height:100vh; object-fit:cover;"></canvas>

    <script>
        const v = document.getElementById('v');
        const c = document.getElementById('c');
        const ctx = c.getContext('2d');

        navigator.mediaDevices.getUserMedia({ video: { facingMode: "environment" } })
            .then(s => { v.srcObject = s; });

        function render() {
            c.width = v.videoWidth / 4; // Lower resolution for speed
            c.height = v.videoHeight / 4;
            ctx.drawImage(v, 0, 0, c.width, c.height);
            
            let f = ctx.getImageData(0, 0, c.width, c.height);
            let d = f.data;
            let hasGreen = false;

            for (let i = 0; i < d.length; i += 4) {
                let r = d[i], g = d[i+1], b = d[i+2];
                // EXTREMELY SENSITIVE GREEN DETECTION
                if (g > 50 && g > r && g > b * 0.8) {
                    hasGreen = true;
                    // Turn green pixels into a blurry grey mask
                    d[i] = 100; d[i+1] = 100; d[i+2] = 100; d[i+3] = 255;
                } else {
                    d[i+3] = 0; // Make everything else invisible
                }
            }
            
            ctx.putImageData(f, 0, 0);
            
            // If green is found, apply a heavy blur to the video
            if (hasGreen) {
                v.style.filter = "blur(20px)";
                c.style.display = "block";
            } else {
                v.style.filter = "blur(0px)";
                c.style.display = "none";
            }
            requestAnimationFrame(render);
        }
        v.onplay = () => render();
    </script>
</body>
</html>
